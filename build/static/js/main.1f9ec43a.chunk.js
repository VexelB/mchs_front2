(this.webpackJsonpm_front=this.webpackJsonpm_front||[]).push([[0],{13:function(t,e,a){},15:function(t,e,a){"use strict";a.r(e);var n=a(2),s=a(3),i=a(4),c=a(6),r=a(5),o=a(1),d=a.n(o),l=a(8),u=a.n(l),p=(a(13),function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,16)).then((function(e){var a=e.getCLS,n=e.getFID,s=e.getFCP,i=e.getLCP,c=e.getTTFB;a(t),n(t),s(t),i(t),c(t)}))}),h=a(0),b=new WebSocket("wss://78.140.214.186:5454"),f={},j=[],v=["Attvalid","Result","rtp","worklife"],O=function(t){Object(c.a)(a,t);var e=Object(r.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return Object(h.jsx)("li",{className:"tables",onClick:this.props.tableClicked,id:this.props.value[0],children:this.props.value[1]})}}]),a}(d.a.Component),m=function(t){Object(c.a)(a,t);var e=Object(r.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var t=this;return Object(h.jsx)("ul",{className:"submenu",children:this.props.tables.map((function(e){return Object(h.jsx)(O,{value:[e,f[e]],tableClicked:t.props.tableClicked},e)}))})}}]),a}(d.a.Component),g=function(t){Object(c.a)(a,t);var e=Object(r.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"renderMenu",value:function(t){return Object(h.jsx)(m,{tableClicked:this.props.tableClicked,tables:t})}},{key:"render",value:function(){return Object(h.jsx)("div",{id:"header",children:Object(h.jsxs)("div",{id:"menu",children:[Object(h.jsxs)("div",{id:"tables",className:"btns",children:["\u0422\u0430\u0431\u043b\u0438\u0446\u044b",this.renderMenu(this.props.tables)]}),Object(h.jsx)("div",{id:"reports",className:"btns",children:"\u041e\u0442\u0447\u0435\u0442\u044b"}),Object(h.jsxs)("div",{id:"options",className:"btns",children:["\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",this.renderMenu(this.props.otables)]})]})})}}]),a}(d.a.Component),w=function(t){Object(c.a)(a,t);var e=Object(r.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"renderShap",value:function(){if(""!==this.props.table)return Object(h.jsx)("div",{id:"shapbtns",children:Object(h.jsx)("button",{id:"addbtn",onClick:this.props.editing,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})}},{key:"render",value:function(){var t=this;return Object(h.jsxs)("div",{id:"maindata",style:{height:"92vh",overflow:"auto"},children:[this.renderShap(),Object(h.jsx)("div",{className:"data",id:this.props.table,children:Object(h.jsxs)("div",{className:"table",children:[this.props.headers.map((function(t,e){return Object(h.jsx)("div",{className:"tablehead",id:t,children:f[t]},t)})),this.props.rows.map((function(e,a){return Object(h.jsx)("div",{className:"row",id:a,onClick:t.props.editing,children:e.map((function(e,n){return Object(h.jsx)("div",{className:"rowEl",id:"row"+a+t.props.headers[n],children:e},"row"+a+t.props.headers[n])}))},a)}))]})},this.props.table)]},"maindata")}}]),a}(d.a.Component),x=function(t){Object(c.a)(a,t);var e=Object(r.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var t=this;return Object(h.jsx)("div",{id:"pages",style:{height:"5vh",overflow:"auto"},children:Object(h.jsx)("div",{className:"pages",id:this.props.table,children:this.props.pages.map((function(e){return Object(h.jsx)("div",{onClick:t.props.pageClick,className:"page",id:e,children:e},e)}))})})}}]),a}(d.a.Component),y=function(t){Object(c.a)(a,t);var e=Object(r.a)(a);function a(){return Object(s.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"renderInputs",value:function(){var t=this,e=[],a=function(a){var n=t.props.headers[a];if(Object.keys(t.props.options).includes(n)){var s=[];e.push(Object(h.jsxs)("div",{children:[f[n]," ",Object(h.jsxs)("select",{className:"input",defaultValue:t.props.data[a],placeholder:f[n],list:"options"+n,id:n,children:[t.props.options[n].forEach((function(e){e===t.props.data[a]?s.push(Object(h.jsx)("option",{selected:"selected",children:e},e)):s.push(Object(h.jsx)("option",{children:e},e))})),s]})]},n))}else n.includes("date")?e.push(Object(h.jsxs)("div",{children:[f[n]," ",Object(h.jsx)("input",{className:"input",id:n,type:"date",placeholder:"\u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414",defaultValue:t.props.data[a]})]},n)):e.push(Object(h.jsxs)("div",{children:[f[n]," ",Object(h.jsx)("input",{className:"input",id:n,defaultValue:t.props.data[a]},"input"+n)]},n))};for(var n in this.props.headers)a(n);return e}},{key:"render",value:function(){return Object(h.jsx)("div",{id:"myModal",className:"modal",children:Object(h.jsx)("div",{className:"modal-content",children:Object(h.jsxs)("div",{children:[Object(h.jsx)("button",{id:"addclose",onClick:this.props.editing,children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},"addclose"),Object(h.jsx)("button",{id:"del",onClick:this.props.editing,style:{color:"red"},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"},"del"),Object(h.jsx)("button",{id:"close",onClick:this.props.editing,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"},"close"),Object(h.jsx)("br",{}),Object(h.jsx)("div",{id:"data",children:this.renderInputs()},"data")]})},"modal-content")},"myModal")}}]),a}(d.a.Component),k=function(t){Object(c.a)(a,t);var e=Object(r.a)(a);function a(t){var n;return Object(s.a)(this,a),(n=e.call(this,t)).get=function(t){var e={action:"get2"};e.table=t;var a=[];if(e.table===n.state.table&&0!==e.page)for(var s in e.sql="select ".concat(n.state.headers.map((function(t){if(j.map((function(t){return t.rowname})).includes(t))for(var n in j)if(j[n].rowname===t)return a.push(j[n].tablename),"".concat(j[n].tablename.split(".")[0],".").concat(j[n].tablerowname," as ").concat(t);return"".concat(e.table,".").concat(t)}))," from ").concat(e.table),a)for(var i in j)a[s]===j[i].tablename&&(e.sql+=" INNER JOIN ".concat(a[s].split(".")[0]," on ").concat(j[i].rowname," = ").concat(a[s]));e.sql+=" order by ".concat(n.state.table,".").concat(n.state.headers[0]," LIMIT ").concat(50*(n.state.page-1),", 50"),b.send(JSON.stringify(e)),e={}},n.vac=function(){var t=[],e=document.querySelectorAll("#data .input");for(var a in e)if(void 0!==e[a].value){var s=e[a].value.trim();j.map((function(t){return t.rowname})).includes(e[a].id)?t.push(""===s?"-":n.state.ids[e[a].id][s]):"password"===e[a].id?t.push("*****"===s?n.state.pass[t[0]]:s):t.push(""===s?"-":s)}return t},n.tableClicked=function(t){n.setState({table:t.target.id,page:1}),setTimeout((function(){}),10),b.send(JSON.stringify({action:"get",table:t.target.id}))},n.valueChange=function(t){n.setState({data:t.target.value})},n.editing=function(t){if(!1===n.state.editing)for(var e in j)n.state.headers.includes(j[e].rowname)&&b.send(JSON.stringify({action:"getopt",table:n.state.table,sql:"SELECT id, '".concat(j[e].rowname,"' as name, ").concat(j[e].tablerowname," as value from ").concat(j[e].tablename.split(".")[0])}));if("close"!==t.target.id)if("addclose"===t.target.id){if("-"===n.vac()[0])return void n.setState({editing:!n.state.editing,data:[],oldid:""});""===n.state.oldid?b.send(JSON.stringify({action:"put",table:n.state.table,values:n.vac()})):b.send(JSON.stringify({action:"change",table:n.state.table,oldid:n.state.oldid,values:n.vac(),headers:n.state.headers})),setTimeout((function(){b.send(JSON.stringify({action:"get",table:n.state.table}))}),10)}else if("rowEl"===t.target.className)n.setState({editing:!n.state.editing,data:n.state.rows[t.target.parentElement.id],oldid:t.target.parentElement.firstChild.innerHTML});else if("del"===t.target.id){if("-"!==n.vac()[0]){var a={action:"delete"};a.sql="DELETE FROM ".concat(n.state.table," where ").concat(n.state.headers[0]," = '").concat(n.vac()[0],"'"),window.confirm("\u0422\u043e\u0447\u043d\u043e \u0443\u0434\u0430\u043b\u0438\u0442\u044c?")&&(b.send(JSON.stringify(a)),setTimeout((function(){b.send(JSON.stringify({action:"get",table:n.state.table}))}),10))}}else n.setState({editing:!n.state.editing,data:[],oldid:""});else n.setState({editing:!n.state.editing,data:[],oldid:""})},n.pageClick=function(t){n.setState({page:t.target.id}),b.send(JSON.stringify({action:"get",table:n.state.table}))},n.state={tables:[],page:0,table:"",headers:[],headwidth:[],rows:[],pages:[],data:[],options:{},oldid:"",ids:{},pass:{},otables:[],editing:!1},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var t=this;b.onclose=function(){alert("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u043e!")},b.onmessage=function(e){var a=JSON.parse(e.data);if("assoc"===a.action)for(var s in a.content)f[a.content[s].name]=a.content[s].value;else if("message"===a.action)alert(a.content);else if("success"===a.action)t.setState({editing:!t.state.editing,data:[],oldid:""});else if("options"===a.action){var i=t.state.options;a.content.forEach((function(e){if(e.id){var a=t.state.ids;a[e.name]={},t.setState({ids:a})}i[e.name]=[]})),a.content.forEach((function(e){if(e.id){var a=t.state.ids;a[e.name][e.value]=e.id,t.setState({ids:a})}i[e.name]=[].concat(Object(n.a)(i[e.name]),[e.value])})),t.setState({options:i})}else if("tables"===a.action){var c=t.state.options;a.content.forEach((function(t){c.tables=[]})),a.content.forEach((function(e){v.includes(e.name)||("apparat"===e.name||"balloon"===e.name||"passedapprovals"===e.name||"people"===e.name||"section"===e.name?(t.setState({tables:[].concat(Object(n.a)(t.state.tables),[e.name])}),c.tables=[].concat(Object(n.a)(c.tables),[f[e.name]])):t.setState({otables:[].concat(Object(n.a)(t.state.otables),[e.name])}))})),t.setState({options:c})}else if("datas"===a.action)a.content.forEach((function(t){var e={};for(var a in t)e[a]=t[a];j.push(e)}));else if("pages"===a.action){for(var r in t.setState({headers:[],pages:[],rows:[]}),a.content[0])t.setState({headers:[].concat(Object(n.a)(t.state.headers),[r]),headwidth:[].concat(Object(n.a)(t.state.headwidth),[1])});for(var o=1;o<=Math.ceil(a.content.length/50);o++)t.setState({pages:[].concat(Object(n.a)(t.state.pages),[o])});setTimeout((function(){t.get(t.state.table)}),10)}else if("rows"===a.action){var d=function(e){var s=[];if(t.state.headers.includes("password")){var i=t.state.pass;i[a.content[e].id]=a.content[e].password,t.setState({pass:i}),s.push(Object.values(a.content[e]).map((function(t){return"password"===Object.keys(a.content[e]).find((function(n){return a.content[e][n]===t}))?"*****":t}))),t.setState({rows:s})}else t.setState({rows:[].concat(Object(n.a)(t.state.rows),[Object.values(a.content[e])])})};for(var l in a.content)d(l);var u=function(e){var a=[];for(var n in a.push(document.querySelector(".table #".concat(t.state.headers[e]))),t.state.rows)a.push(document.querySelector("#row".concat(n).concat(t.state.headers[e])));var s=[];a.forEach((function(t){s.push(t.offsetWidth)})),a.forEach((function(t){t.setAttribute("style","width: ".concat(Math.max.apply(Math,s),"px"))}))};for(var p in t.state.headers)u(p)}}}},{key:"renderHeader",value:function(){return Object(h.jsx)(g,{tableClicked:this.tableClicked,tables:this.state.tables,otables:this.state.otables})}},{key:"renderMainData",value:function(){return Object(h.jsx)(w,{table:this.state.table,headers:this.state.headers,headwidth:this.state.headwidth,rows:this.state.rows,editing:this.editing})}},{key:"renderPages",value:function(){return Object(h.jsx)(x,{table:this.state.table,pages:this.state.pages,pageClick:this.pageClick})}},{key:"renderEditor",value:function(){if(this.state.editing)return Object(h.jsx)(y,{editing:this.editing,headers:this.state.headers,data:this.state.data,options:this.state.options,ids:this.state.ids})}},{key:"render",value:function(){return Object(h.jsxs)("div",{className:"App",children:[this.renderHeader(),Object(h.jsxs)("div",{id:"main",children:[this.renderEditor(),this.renderMainData(),this.renderPages()]})]})}}]),a}(d.a.Component);u.a.render(Object(h.jsx)(k,{}),document.getElementById("root")),p()}},[[15,1,2]]]);
//# sourceMappingURL=main.1f9ec43a.chunk.js.map