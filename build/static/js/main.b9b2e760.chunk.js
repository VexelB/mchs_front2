(this.webpackJsonpm_front=this.webpackJsonpm_front||[]).push([[0],{13:function(t,e,a){},15:function(t,e,a){"use strict";a.r(e);var s=a(2),n=a(3),i=a(4),c=a(6),o=a(5),r=a(1),d=a.n(r),l=a(8),p=a.n(l),u=(a(13),function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,16)).then((function(e){var a=e.getCLS,s=e.getFID,n=e.getFCP,i=e.getLCP,c=e.getTTFB;a(t),s(t),n(t),i(t),c(t)}))}),h=a(0),b=new WebSocket("wss://78.140.214.186:5454"),f={},j=[],v=["Attvalid","Result","rtp","worklife"],O=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(){return Object(n.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var t=this;return Object(h.jsx)("ul",{className:"submenu",children:this.props.tables.map((function(e){return Object(h.jsx)("li",{className:"tables",onClick:t.props.tableClicked,id:e,children:f[e]})}))})}}]),a}(d.a.Component),m=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(){return Object(n.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return Object(h.jsx)("div",{id:"header",children:Object(h.jsxs)("div",{id:"menu",children:[Object(h.jsxs)("div",{id:"tables",className:"btns",children:["\u0422\u0430\u0431\u043b\u0438\u0446\u044b",Object(h.jsx)(O,{tableClicked:this.props.tableClicked,tables:this.props.tables})]}),Object(h.jsx)("div",{id:"reports",className:"btns",children:"\u041e\u0442\u0447\u0435\u0442\u044b"}),Object(h.jsxs)("div",{id:"options",className:"btns",children:["\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438",Object(h.jsx)(O,{tableClicked:this.props.tableClicked,tables:this.props.otables})]}),Object(h.jsx)("div",{id:"exit",className:"btns",onClick:function(){window.location.href=window.location.href},children:"\u0412\u044b\u0445\u043e\u0434"})]})})}}]),a}(d.a.Component),g=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(){return Object(n.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"renderShap",value:function(){if(""!==this.props.table)return Object(h.jsx)("div",{id:"shapbtns",children:Object(h.jsx)("button",{id:"addbtn",onClick:this.props.editing,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})}},{key:"render",value:function(){var t=this;return Object(h.jsxs)("div",{id:"maindata",style:{height:"92vh",overflow:"auto"},children:[this.renderShap(),Object(h.jsx)("div",{className:"data",id:this.props.table,children:Object(h.jsxs)("div",{className:"table",children:[this.props.headers.map((function(t,e){return Object(h.jsx)("div",{className:"tablehead",id:t,children:f[t]},t)})),this.props.rows.map((function(e,a){return Object(h.jsx)("div",{className:"row",id:a,onClick:t.props.editing,children:e.map((function(e,s){return Object(h.jsx)("div",{className:"rowEl",id:"row"+a+t.props.headers[s],children:e},"row"+a+t.props.headers[s])}))},a)}))]})},this.props.table)]},"maindata")}}]),a}(d.a.Component),w=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(){return Object(n.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var t=this;return Object(h.jsx)("div",{id:"pages",style:{height:"5vh",overflow:"auto"},children:Object(h.jsx)("div",{className:"pages",id:this.props.table,children:this.props.pages.map((function(e){return Object(h.jsx)("div",{onClick:t.props.pageClick,className:"page",id:e,children:e},e)}))})})}}]),a}(d.a.Component),x=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(){return Object(n.a)(this,a),e.apply(this,arguments)}return Object(i.a)(a,[{key:"renderInputs",value:function(){var t=this,e=[],a=function(a){var s=t.props.headers[a];if(Object.keys(t.props.options).includes(s)){var n=[];e.push(Object(h.jsxs)("div",{children:[f[s]," ",Object(h.jsxs)("select",{className:"input",defaultValue:t.props.data[a],placeholder:f[s],list:"options"+s,id:s,children:[t.props.options[s].forEach((function(e){e===t.props.data[a]?n.push(Object(h.jsx)("option",{selected:"selected",children:e},e)):n.push(Object(h.jsx)("option",{children:e},e))})),n]})]},s))}else s.includes("date")?e.push(Object(h.jsxs)("div",{children:[f[s]," ",Object(h.jsx)("input",{className:"input",id:s,type:"date",placeholder:"\u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414",defaultValue:t.props.data[a]})]},s)):"id"===s?t.props.data[a]?e.push(Object(h.jsxs)("div",{children:[f[s]," ",Object(h.jsx)("input",{readOnly:!0,className:"input",id:s,defaultValue:t.props.data[a]},"input"+s)]},s)):e.push(Object(h.jsxs)("div",{children:[f[s]," ",Object(h.jsx)("input",{readOnly:!0,className:"input",id:s,defaultValue:t.props.rows.length+1},"input"+s)]},s)):e.push(Object(h.jsxs)("div",{children:[f[s]," ",Object(h.jsx)("input",{className:"input",id:s,defaultValue:t.props.data[a]},"input"+s)]},s))};for(var s in this.props.headers)a(s);return e}},{key:"render",value:function(){return Object(h.jsx)("div",{id:"myModal",className:"modal",children:Object(h.jsx)("div",{className:"modal-content",children:Object(h.jsxs)("div",{children:[Object(h.jsx)("button",{id:"addclose",onClick:this.props.editing,children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},"addclose"),Object(h.jsx)("button",{id:"del",onClick:this.props.editing,style:{color:"red"},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"},"del"),Object(h.jsx)("button",{id:"close",onClick:this.props.editing,children:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"},"close"),Object(h.jsx)("br",{}),Object(h.jsx)("div",{id:"data",children:this.renderInputs()},"data")]})},"modal-content")},"myModal")}}]),a}(d.a.Component),y=function(t){Object(c.a)(a,t);var e=Object(o.a)(a);function a(t){var s;return Object(n.a)(this,a),(s=e.call(this,t)).get=function(t){var e={action:"get2"};e.table=t;var a=[];if(e.table===s.state.table&&0!==e.page)for(var n in e.sql="select ".concat(s.state.headers.map((function(t){if(j.map((function(t){return t.rowname})).includes(t))for(var s in j)if(j[s].rowname===t)return a.push(j[s].tablename),"".concat(j[s].tablename.split(".")[0],".").concat(j[s].tablerowname," as ").concat(t);return"".concat(e.table,".").concat(t)}))," from ").concat(e.table),a)for(var i in j)a[n]===j[i].tablename&&(e.sql+=" INNER JOIN ".concat(a[n].split(".")[0]," on ").concat(j[i].rowname," = ").concat(a[n]));e.sql+=" order by ".concat(s.state.table,".").concat(s.state.headers[0]," LIMIT ").concat(50*(s.state.page-1),", 50"),b.send(JSON.stringify(e)),e={}},s.vac=function(){var t=[],e=document.querySelectorAll("#data .input");for(var a in e)if(void 0!==e[a].value){var n=e[a].value.trim();j.map((function(t){return t.rowname})).includes(e[a].id)?t.push(""===n?"-":s.state.ids[e[a].id][n]):"password"===e[a].id?t.push("*****"===n?s.state.pass[t[0]]:n):t.push(""===n?"-":n)}return t},s.tableClicked=function(t){s.setState({table:t.target.id,page:1}),setTimeout((function(){}),10),b.send(JSON.stringify({action:"get",table:t.target.id}))},s.valueChange=function(t){s.setState({data:t.target.value})},s.editing=function(t){if(!1===s.state.editing)for(var e in j)s.state.headers.includes(j[e].rowname)&&b.send(JSON.stringify({action:"getopt",table:s.state.table,sql:"SELECT id, '".concat(j[e].rowname,"' as name, ").concat(j[e].tablerowname," as value from ").concat(j[e].tablename.split(".")[0])}));if("close"!==t.target.id)if("addclose"===t.target.id){if("-"===s.vac()[0])return void s.setState({editing:!s.state.editing,data:[],oldid:""});""===s.state.oldid?b.send(JSON.stringify({action:"put",table:s.state.table,values:s.vac()})):b.send(JSON.stringify({action:"change",table:s.state.table,oldid:s.state.oldid,values:s.vac(),headers:s.state.headers})),setTimeout((function(){b.send(JSON.stringify({action:"get",table:s.state.table}))}),10)}else if("rowEl"===t.target.className)s.setState({editing:!s.state.editing,data:s.state.rows[t.target.parentElement.id],oldid:t.target.parentElement.firstChild.innerHTML});else if("del"===t.target.id){if("-"!==s.vac()[0]){var a={action:"delete"};a.sql="DELETE FROM ".concat(s.state.table," where ").concat(s.state.headers[0]," = '").concat(s.vac()[0],"'"),window.confirm("\u0422\u043e\u0447\u043d\u043e \u0443\u0434\u0430\u043b\u0438\u0442\u044c?")&&(b.send(JSON.stringify(a)),setTimeout((function(){b.send(JSON.stringify({action:"get",table:s.state.table}))}),10))}}else s.setState({editing:!s.state.editing,data:[],oldid:""});else s.setState({editing:!s.state.editing,data:[],oldid:""})},s.pageClick=function(t){s.setState({page:t.target.id}),b.send(JSON.stringify({action:"get",table:s.state.table}))},s.state={tables:[],table:"",page:0,headers:[],headwidth:[],rows:[],pages:[],data:[],options:{},oldid:"",ids:{},pass:{},otables:[],editing:!1},s}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var t=this;b.onclose=function(){alert("\u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u043c \u043f\u043e\u0442\u0435\u0440\u044f\u043d\u043e!")},b.onmessage=function(e){var a=JSON.parse(e.data);if("assoc"===a.action)for(var n in a.content)f[a.content[n].name]=a.content[n].value;else if("message"===a.action)alert(a.content);else if("success"===a.action)t.setState({editing:!t.state.editing,data:[],oldid:""});else if("options"===a.action){var i=t.state.options;a.content.forEach((function(e){if(e.id){var a=t.state.ids;a[e.name]={},t.setState({ids:a})}i[e.name]=[]})),a.content.forEach((function(e){if(e.id){var a=t.state.ids;a[e.name][e.value]=e.id,t.setState({ids:a})}i[e.name]=[].concat(Object(s.a)(i[e.name]),[e.value])})),t.setState({options:i})}else if("tables"===a.action){var c=t.state.options;a.content.forEach((function(t){c.tables=[]})),a.content.forEach((function(e){v.includes(e.name)||("apparat"===e.name||"balloon"===e.name||"passedapprovals"===e.name||"people"===e.name||"section"===e.name?(t.setState({tables:[].concat(Object(s.a)(t.state.tables),[e.name])}),c.tables=[].concat(Object(s.a)(c.tables),[f[e.name]])):t.setState({otables:[].concat(Object(s.a)(t.state.otables),[e.name])}))})),t.setState({options:c})}else if("datas"===a.action)a.content.forEach((function(t){var e={};for(var a in t)e[a]=t[a];j.push(e)}));else if("pages"===a.action){for(var o in t.setState({headers:[],pages:[],rows:[]}),a.content[0])t.setState({headers:[].concat(Object(s.a)(t.state.headers),[o]),headwidth:[].concat(Object(s.a)(t.state.headwidth),[1])});for(var r=1;r<=Math.ceil(a.content.length/50);r++)t.setState({pages:[].concat(Object(s.a)(t.state.pages),[r])});setTimeout((function(){t.get(t.state.table)}),10)}else if("rows"===a.action){var d=function(e){var n=[];if(t.state.headers.includes("password")){var i=t.state.pass;i[a.content[e].id]=a.content[e].password,t.setState({pass:i}),n.push(Object.values(a.content[e]).map((function(t){return"password"===Object.keys(a.content[e]).find((function(s){return a.content[e][s]===t}))?"*****":t}))),t.setState({rows:n})}else t.setState({rows:[].concat(Object(s.a)(t.state.rows),[Object.values(a.content[e])])})};for(var l in a.content)d(l);var p=function(e){var a=[];for(var s in a.push(document.querySelector(".table #".concat(t.state.headers[e]))),t.state.rows)a.push(document.querySelector("#row".concat(s).concat(t.state.headers[e])));var n=[];a.forEach((function(t){n.push(t.offsetWidth)})),a.forEach((function(t){t.setAttribute("style","width: ".concat(Math.max.apply(Math,n),"px"))}))};for(var u in t.state.headers)p(u)}}}},{key:"renderEditor",value:function(){if(this.state.editing)return Object(h.jsx)(x,{editing:this.editing,headers:this.state.headers,data:this.state.data,options:this.state.options,ids:this.state.ids,rows:this.state.rows})}},{key:"render",value:function(){return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)(m,{tableClicked:this.tableClicked,tables:this.state.tables,otables:this.state.otables}),Object(h.jsxs)("div",{id:"main",children:[this.renderEditor(),Object(h.jsx)(g,{table:this.state.table,headers:this.state.headers,headwidth:this.state.headwidth,rows:this.state.rows,editing:this.editing}),Object(h.jsx)(w,{table:this.state.table,pages:this.state.pages,pageClick:this.pageClick})]})]})}}]),a}(d.a.Component);p.a.render(Object(h.jsx)(y,{}),document.getElementById("root")),u()}},[[15,1,2]]]);
//# sourceMappingURL=main.b9b2e760.chunk.js.map